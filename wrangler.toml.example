name = "sekai-pass"
main = "src/index.ts"
compatibility_date = "2024-01-01"
compatibility_flags = ["nodejs_compat"]

[vars]
ENVIRONMENT = "production"
TURNSTILE_SITE_KEY = "1x00000000000000000000AA"  # 替换为实际值

# Static assets configuration
[assets]
directory = "public"
binding = "ASSETS"
not_found_handling = "404-page"

# 配置说明：
# 1. 复制此文件为 wrangler.toml
# 2. 运行 `npx wrangler d1 create sekai_pass_db` 创建数据库
# 3. 将输出的 database_id 填入下方
# 4. 运行 `npx wrangler d1 execute sekai_pass_db --remote --file=./schema.sql` 应用架构

[[d1_databases]]
binding = "DB"
database_name = "sekai_pass_db"
database_id = "your-database-id-here"  # 替换为你的 database_id

# KV namespace for signing key cache
[[kv_namespaces]]
binding = "KV"
id = "YOUR_KV_NAMESPACE_ID"  # Run: wrangler kv:namespace create "OIDC_KEYS"
preview_id = "YOUR_PREVIEW_KV_NAMESPACE_ID"  # Run: wrangler kv:namespace create "OIDC_KEYS" --preview

# Cron trigger for key rotation (weekly on Sunday at midnight)
[triggers]
crons = ["0 0 * * 0"]

